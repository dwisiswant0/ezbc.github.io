<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Elijah's Webpage  &mdash; Summarizing the MLE Method </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="alternate" type="application/atom+xml" title="Elijah's Webpage" href="/feed.xml">
        <!-- Loop and attach page tags from page meta section -->
        
        <meta name="keywords" content="Taurus-California-PerseusResidualsMasking">
        
        <link rel="icon" type="image/png"
            href="/favicon.png">


        <!-- Clicks
        <script
            src="/assets/js/click.js">
        </script>
        -->

        <!-- Custom CSS -->
        <link rel="stylesheet"
            href="/assets/css/main.css">
        <link rel="stylesheet" media="print"
            href="/assets/css/print.css"/>
        <link
            href='http://fonts.googleapis.com/css?family=Poly:400,400italic'
            rel='stylesheet' type='text/css'>

        <!-- JQuery -->
        <script
            src="/assets/js/jquery-1.10.2.js">
        </script>

        <!-- Loading Bar -->
        <script
            src="/assets/js/pace.min.js">
        </script>

        <!-- Owl-carousel -->
        <link rel="stylesheet" href="/plugins/owlcarousel/owl.carousel.min.css">
        <link rel="stylesheet"
            href="/plugins/owlcarousel/owl.theme.default.min.css">

        <!-- Slick Carousel -->
        <link rel="stylesheet" type="text/css"
            href="/plugins_html/slick-1.5.7/slick/slick-theme.css"/>
        <link rel="stylesheet" type="text/css"
            href="/plugins_html/slick-1.5.7/slick/slick.css">
        <script type="text/javascript"
            src="//code.jquery.com/jquery-1.11.0.min.js">
        </script>
        <script type="text/javascript"
            src="//code.jquery.com/jquery-migrate-1.2.1.min.js">
        </script>
        <script type="text/javascript"
            src="/plugins_html/slick-1.5.7/slick/slick.min.js">
        </script>

        <!-- Bootstrap -->
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <!-- Table of Contents -->
        <script
            src="/assets/js/jquery.toc.js">
        </script>

        <!-- Image Zoom -->
        <script
            src="/plugins_html/elevatezoom-master/jquery.elevatezoom.js" 
            type="text/javascript">
        </script>
        
        <!-- JS functions -->
        <script
            type="text/javascript"
            src="/assets/js/application.js">
        </script>

        <!-- Slick Carousel -->
        <script
            type="text/javascript"
            src="/assets/js/image_carousel.js">
        </script>

        <!-- Mathjax -->
        <script 
            type="text/javascript" 
            src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
        <!-- allow single dollar sign escape for mathjax -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
            tex2jax: {
              inlineMath: [ ['$','$'], ],
              processEscapes: true,
              processEnvironments: true,
            },
            TeX: {
              Macros: {
                nhi : "N(HI)",
                htwo : "H_2",
                in : "^{\\prime\\prime}",
                ft : "^{\\prime}",
                deg : "^\\circ",
              }
            }
          });
        </script>

        <script 
            src="/assets/js/jquery.toc.js">
        </script>


        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-67026116-1', 'auto');
          ga('send', 'pageview');
        

        </script>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>



<!--
<style>
body { 
  background-padding: 0 !important;
  background-image: url('/images/background.jpg');
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-position: left;
  background-min-width: 100px;
}
</style>
-->

<main>

<body>
    <!-- <span class="statusbar"></span> -->
    <!-- Wrap all page content here -->
    <div id="wrap">
        <div id="body" class="container">
            <div class="row row-offcanvas row-offcanvas-left">
                <!-- side navigation -->
                <nav id="nav" role="navigation" class="col-sm-2 sidebar-offcanvas">
                    <header id="menu" role="banner">
                        <p class="menu-title">Close</p>
                        <a href="#nav" class="close-btn">
                            <img src="/assets/fonts/close-btn.svg" alt="close button">
                        </a>
                    </header>
                    <ul class="sidebar" >

<!-- sort in alphebetical order -->
    <p class="separator">Navigation</p>
    <li><a href="/">Home</a></li>
    <li><a href="/research_log">Research Log</a></li>
    <li><a href="/hobbies">Hobbies</a></li>
    <li><a href="/contact">Contact</a></li>
    <li><a href="/search">Search</a></li>
    <li><a href="/tags">Tags</a></li>
    
    <a class="goto-top-link hide-on-phone" href="#top">
        <div class="goto-top text-center">
            <i class="fa fa-step-forward fa-rotate-270"></i>
        </div>
    </a>

</ul>
                    
                </nav>

                

                <header id="menu" role="banner">
                    <p class="menu-title">Menu</p>
                    <a href="#nav" class="menu-btn">
                        <img src="/assets/fonts/menu-btn.svg" alt="menu button">
                    </a>
                </header>
                <!-- Content -->
                <div class="col-sm-10">
                    <nav class="top">
                        <a href="/index.html">Blogs, astro, and more &mdash; Elijah's Webpage</a>
                        <span class="pull-right">
                            <a id="twitter-ic" class="link" href="https://twitter.com/ebernste1">
                                <i class="fa fa-twitter fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link" href="https://github.com/ezbc">
                                <i class="fa fa-github-square fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link" href="https://bitbucket.org/ezbc">
                                <i class="fa fa-bitbucket-square fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link"
                                href="https://plus.google.com/+ElijahBernsteinCooper">
                                <i class="fa fa-google-plus fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link"
                                href="https://linkedin.com/in/ElijahBernsteinCooper">
                                <i class="fa fa-linkedin fa-lg"></i>
                            </a>
                            </a>
                            <a id="rss-ic" class="link" href="/feed.xml">
                                <i class="fa fa-rss fa-lg"></i>
                            </a>
                        </span>
                    </nav>
                    <div class="row">
                        <body>
    <div class="col-sm-12">
        <div class="page">
            <div class="page-title">
                Summarizing the MLE Method
                <div class="meta">    			
                    
                    By Elijah Bernstein-Cooper,
                    
                    July 24, 2015,
                    <a href="/research/2015/07/24/MLE-Summary/#disqus_thread">0 <i class="fa fa-comments-o fa-lg"></i></a>
                    comments.
                </div>
            </div>
            <div class="page-content">
                <h2 id="masking-summary">Masking Summary</h2>

<p>The masking procedure requires </p>

<ol>
  <li>
    <p>Mask all but faintest 10% of pixels.</p>
  </li>
  <li>
    <p>Fit a model <script type="math/tex">A_V</script> using a linear least squares fit, deriving a DGR and an
intercept.</p>
  </li>
  <li>
    <p>Unmask the next faintest 5% of pixels.</p>
  </li>
  <li>
    <p>Mask the residuals by fitting residuals <script type="math/tex">% <![CDATA[
< 0  %]]></script> mag with a Gaussian. Mask
all pixels more than 3 times the standard deviation of the fitted Gaussian.</p>
  </li>
  <li>
    <p>Repeat steps 2 through 5 until the fitted DGR converges to within 1%. Supply
the mask from step 4 to step 2.</p>
  </li>
</ol>

<hr />

<div align="center"> Perseus </div>

<p><img src="/images/2015-07-24/perseus_planck_binned_coarseres_residual_maps.gif" style="width: 100%;" /></p>

<div align="center"> Taurus </div>

<p><img src="/images/2015-07-24/taurus_planck_binned_coarseres_residual_maps.gif" style="width: 100%;" /></p>

<div align="center"> California </div>

<p><img src="/images/2015-07-24/california_planck_binned_coarseres_residual_maps.gif" style="width: 100%;" /></p>

<p>Figure 1. - Masked maps of each cloud for each iteration. Left: The
fractional-masked map from step 3. Right: The residual-masked map from step 4.
The residual mask begins excluding most added pixels from the fractional mask
after just a few iterations.</p>

<hr />

<p>We examine the residual masking more closely by plotting the distribution of
the  residuals and the fitted Gaussian performed in step 4. Plotted below are
kernel density PDFs with the fitted Gaussian, and the residual cut-off for each
iteration.</p>

<p>Kernel density plots are PDFs created by smoothing each data point by some
kernel, then adding the contributions of each data point together.
<a href="http://davidalexanderellis.blogspot.com/2012/10/kernel-density-plots-has-histogram-had.html">Here</a>
is a simple outline of why to use a KD plot.
<a href="https://chemicalstatistician.wordpress.com/2013/06/09/exploratory-data-analysis-kernel-density-estimation-in-r-on-ozone-pollution-data-in-new-york-and-ozonopolis/">Here</a>
is a more in-depth description. The choice of the kernel shape can be tricky,
but there is plenty of literature and well-established methods. The advantage
of a Kernel density plot is that there is always a unique answer, quite unlike
histograms.</p>

<hr />

<p>Perseus</p>

<p><img src="/images/2015-07-24/perseus_planck_binned_coarseres_residual_hists.gif" style="width: 50%;" /></p>

<p>Taurus</p>

<p><img src="/images/2015-07-24/taurus_planck_binned_coarseres_residual_hists.gif" style="width: 50%;" /></p>

<p>California</p>

<p><img src="/images/2015-07-24/california_planck_binned_coarseres_residual_hists.gif" style="width: 50%;" /></p>

<p>Figure 2. - Residual kernel density plots for each cloud at each iteration. The
residual PDF is in black, and the fitted Gaussian in purple. The residual
cut-off is the dashed black line. These make it obvious that the majority of
data points are masked by residual masking.</p>

<hr />

<h2 id="a-namelikelihoodsalikelihoods"><a name="likelihoods"></a>Likelihoods</h2>

<p>In the previous <a href="/research/2015/07/22/MLE-Testing/">post</a> the MLE calculation found
<script type="math/tex">HI</script> from a chance intermediate-velocity cloud along the line of sight in
Perseus reproduced the observed <script type="math/tex">A_V</script> in the Lee+12 dataset. The image below
shows the <script type="math/tex">HI</script> channel at -45 km/s. Overplotted is the <script type="math/tex">A_V = 1</script> mag
contour, roughly tracing the outline of the mask.</p>

<hr />

<p><img src="/images/2015-07-24/perseus_ivc.png" style="width: 100%;" /></p>

<p>Figure 3. - Perseus <script type="math/tex">HI</script> emission at -45 km/s overlaid with mask contour.</p>

<hr />

<p>IVCs are present in the north-west and south-west corners of the region. This
additional <script type="math/tex">HI</script> emission, at -45 km/s, would only be included in the Perseus
<script type="math/tex">N(HI)</script> map if the velocity width were about 100 km/s. This is exactly what
the MLE code finds in the Lee+12 data. There are two peaks in the likelihood
space, one at 40 km/s and one at 100 km/s. This means that the dust column
density along the line of sight includes some dust contributed by these IVCs.</p>

<p>This likely means the code is doing its job: finding the <script type="math/tex">HI</script> which best
traces the dust column density. It is up to us to exclude widths which are
unrealistic for GMCs.</p>

<hr />

<p><img src="/images/2015-07-24/taurus_ivc.png" style="width: 100%;" /></p>

<p>Figure 3. - Taurus <script type="math/tex">HI</script> emission at -33 km/s overlaid with mask contour. </p>

<hr />

<p><a href="http://iopscience.iop.org/0004-637X/732/2/78/article#apj386015s3-3">Imara et al.
(2011a)</a>
searched for cloud <script type="math/tex">HI</script> emission across an <script type="math/tex">HI</script> width of <script type="math/tex">\pm 20</script> km/s
around the CO line center for clouds in the Milky Way. In their study of M33
clouds <a href="http://iopscience.iop.org/0004-637X/732/2/79/article#apj386016s3-1">(Imara et al.
2011b)</a>,
they consider a larger range, <script type="math/tex">\pm 25</script> km/s, over which to search for a GMC’s
<script type="math/tex">HI</script> extent.</p>


                <!-- Share & Comments -->
                <div class="share">
    <p>Posted:
        <i>
            Friday 24 July 2015
        </i>
        <a class="pull-right" href="https://twitter.com/intent/tweet?url=/research/2015/07/24/MLE-Summary/&text=Summarizing the MLE Method&via=ebernste1" target="_blank">
            <i class="fa fa-retweet" style="color:red;"></i> Share
        </a>
    </p>
    
       <ul>
           <li>Related:</li>
           <ul>
           
              
                  <li>
                      <a href="/research/2015/11/04/varying-phi-g-in-mc/">Varying Dust Opacity and Gas Temperatures</a>
                  </li>
              
                  <li>
                      <a href="/research/2015/11/01/gas-temperatures/">Gas Temperatures</a>
                  </li>
              
                  <li>
                      <a href="/research/2015/10/22/model-fits/">Addressing Core Variation</a>
                  </li>
              
           </ul>
       </ul>
    
</div>

<div class="comments">
    <div id="disqus_thread"></div>
</div>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

            
            </div>
        </div>
    </div>
</body>
        
<!-- Disques -->
<script>
    $(".page-preview-icon").hover(function(){
        $(this).parents(".page-nav").css("z-index","5000");
    });
    
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'httpezbcme'; // required: replace example with your forum shortname

/** Err
var disqus_identifier = '2015-07-24-MLE-Summary.md';
var disqus_url = '/research/2015/07/24/MLE-Summary/';
**/
   
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();



/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'httpezbcme'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());

</script>


                    </div>
                </div>
            </div>
        </div>
        <footer class="footer text-center meta">
            Powered by <a class="link" href="https://github.com/nadjetey/wangana">Wangana</a> &mdash; Jekyll theme.
        </footer>
    </div>
</body>
</main>
        <!-- Other JavaScripts -->
        <script src="/assets/js/bootstrap.min.js"></script>        
        <script src="/assets/js/jquery.timeago.js"></script>
        <script>
          (function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

ga('create', 'ezbc', 'ezbc');
ga('send', 'pageview');
          $(document).ready(function() {
    var timer;

    $(window).bind('scroll', (function() {
        clearTimeout(timer);
        timer = setTimeout(getPercent, 5);
        isTop();
    }));

    $(".goto-top-link").click(function(){
        event.preventDefault();
        $('html, body').animate({ scrollTop: 0 }, 'slow');
    });
});

function scrollPossition() {
    return ($(window).scrollTop() / ($(document).height() - $(window).height())) * 100;
}

function getPercent() {
    $(".statusbar").css("width", String(scrollPossition()) + "%");

    if (scrollPossition() > 97) {
        $(".statusbar").css("background-color", "#1ca265");
    } else {
        $(".statusbar").css("background-color", "#eb5e29");
    }
    return;
}

function isTop() {
  if(scrollPossition() > 30)
    $(".goto-top").fadeIn("slow");
  else
    $(".goto-top").fadeOut("slow");
}
          $(document).ready(function() {
    $('.menu-btn').click(function() {
        $('.row-offcanvas').toggleClass('active');
    });
    $('.close-btn').click(function() {
        $('.row-offcanvas').toggleClass('active');
    });
});
          jQuery(document).ready(function() {
    jQuery("time.timeago").timeago();
});
        </script>


        <!-- Owl-carousel -->
        <script src="jquery.min.js"></script>
        <script src="owlcarousel/owl.carousel.min.js"></script>

    </body>
</html>



